<head>
	<title>FKeys Helper</title>
	<meta name="viewport" content="user-scalable=no, width=device-width">
	<meta charset="UTF-8">

	<link href="css/bootstrap.min.css" rel="stylesheet" >
	<link href="css/style.css" rel="stylesheet" type="text/css">

	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
</head>

<body>
	FKeys Page: <textarea id="outbound" rows="5"></textarea>&nbsp;&nbsp;
	<button onclick="compute(0)">Go</button>&nbsp;&nbsp;<button onclick="clear_input(0)">Clear</button><br/>
<!--
	Inbound DSN: <textarea id="dsn" rows="5"></textarea>
	<button onclick="compute(3)">Go</button>&nbsp;&nbsp;<button onclick="clear_input(3)">Clear</button><br/>
	Inbound List: <textarea id="inbound" rows="5"></textarea>&nbsp;&nbsp;
	<button onclick="compute(1)">Go</button>&nbsp;&nbsp;<button onclick="clear_input(1)">Clear</button><br/>
	Rollover List: <textarea id="rollover" rows="5"></textarea>&nbsp;&nbsp;
	<button onclick="compute(2)">Go</button>&nbsp;&nbsp;<button onclick="clear_input(2)">Clear</button><br/>
	Ans: <textarea id="ans_txt" rows="5" style="width:300px"></textarea>
-->
	<div id="total"></div>
</body>

<script>
var gates = {};
var gate_changes = {};
var inbounds = {};

function compute (type = -1) {
	var output = "";
    var reg;
    $("#total").html("");
	rega = /TOW\n(\d+)\n(\d+)\n[\s\S]*LDW\n(\d+)\n(\d+)\n/g;
	regb = /Flight\n\n([A-Z]{4})[\s\S]+AAL(\d+)\n\!\nC I\:[^\(]+\([^\s]+\s([^\,]+)\,[\s\S]+\)\n([A-Za-z0-9]{3})\nMEL/g;
	
	var fkeystxt = $("#outbound").val();
	if ((result = rega.exec(fkeystxt)) != null) {
		var mlwa = parseInt(result[2]) - parseInt(result[1]);
		var mlwb = parseInt(result[4]) - parseInt(result[3]);
		output = "MTOW SPREAD: ";
		if (mlwa < mlwb) {
			output += ((mlwa > 9999) ? "10K+" : mlwa);
		} else {
			output += '<span style="color:';
			if (mlwb <= 2000) {
				output += 'red';
			} else if (mlwb <= 5000) {
				output += 'orange';
			} else {
				output += 'green';
			}
			output += '"><b>' + ((mlwb > 9999) ? "10K+" : mlwb) + "</b></span> || Land Wgt Rstr";
		}
	} else {
		console.log("regb parse error");
	}
	if ((result = regb.exec(fkeystxt)) != null) {
		var tmpres = result[2] + '&nbsp;&nbsp;&nbsp;' + result[1] + '&nbsp;&nbsp;&nbsp;' + result[4] + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + result[3];
		output = tmpres + '<br/>' + output;
	}
	$("#total").html('<br/>' + output);
	$("#outbound").val("");
}
	
Array.prototype.unique = function() {
    return this.filter(function (value, index, self) {
      return self.indexOf(value) === index;
    });
}

function get_month_name(id = -1) {
	if (id < 0 || id > 11) { return "NULL"; }
	return ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"][id];
}

function today(report_date = true) {
	var today = new Date();
	if (report_date && today.getHours() > 15) {
		today.setDate(today.getDate() + 1);
	}
	return (((today.getDate() < 10) ? ("0" + today.getDate()) : today.getDate()) + "-" +
		get_month_name(today.getMonth()) + "-" + today.getFullYear());
}

function clear_input (type = -1) {
	if (type == 0) {
		$("#outbound").val("");
	}
	$("total").html("");
}
</script>
